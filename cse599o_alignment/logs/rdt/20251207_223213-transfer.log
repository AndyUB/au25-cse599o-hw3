Args: Namespace(ckpt_file='cse599o_alignment/ckpt/model.pt', result_dir='cse599o_alignment/results/rdt/20251207_223213/transfer_only', steps=10, warmup_steps=3, verbose=True).
2025-12-07 22:32:26,034	INFO worker.py:2012 -- Started a local Ray instance.
2025-12-07 22:32:26,461	INFO packaging.py:588 -- Creating a file package for local module '/homes/iws/yhruan22/au25-cse599o-hw3'.
2025-12-07 22:32:26,541	WARNING packaging.py:430 -- File /homes/iws/yhruan22/au25-cse599o-hw3/cse599o_alignment/ckpt/model.pt is very large (243.85MiB). Consider adding this file to the 'excludes' list to skip uploading it: `ray.init(..., runtime_env={'excludes': ['/homes/iws/yhruan22/au25-cse599o-hw3/cse599o_alignment/ckpt/model.pt']})`
2025-12-07 22:32:28,989	INFO packaging.py:380 -- Pushing file package 'gcs://_ray_pkg_90d5faaae22fcea5.zip' (245.68MiB) to Ray cluster...
2025-12-07 22:32:29,689	INFO packaging.py:393 -- Successfully pushed file package 'gcs://_ray_pkg_90d5faaae22fcea5.zip'.
/homes/iws/yhruan22/au25-cse599o-hw3/.venv/lib64/python3.12/site-packages/ray/_private/worker.py:2051: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
Ray initialized.
[33m(raylet)[0m warning: `VIRTUAL_ENV=/homes/iws/yhruan22/au25-cse599o-hw3/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead
[33m(raylet)[0m Using CPython 3.12.9 interpreter at: /usr/bin/python3
[33m(raylet)[0m Creating virtual environment at: .venv
[33m(raylet)[0m    Building alignment @ file:///homes/iws/yhruan22/raytmp/session_2025-12-07_22-32-20_409966_3162064/runtime_resources/working_dir_files/_ray_pkg_90d5faaae22fcea5
[33m(raylet)[0m    Building cse599o-basics @ file:///homes/iws/yhruan22/raytmp/session_2025-12-07_22-32-20_409966_3162064/runtime_resources/working_dir_files/_ray_pkg_90d5faaae22fcea5/cse599o-basics
[33m(raylet)[0m       Built cse599o-basics @ file:///homes/iws/yhruan22/raytmp/session_2025-12-07_22-32-20_409966_3162064/runtime_resources/working_dir_files/_ray_pkg_90d5faaae22fcea5/cse599o-basics
[33m(raylet)[0m       Built alignment @ file:///homes/iws/yhruan22/raytmp/session_2025-12-07_22-32-20_409966_3162064/runtime_resources/working_dir_files/_ray_pkg_90d5faaae22fcea5
[33m(raylet)[0m Installed 205 packages in 7.16s
[33m(raylet)[0m warning: `VIRTUAL_ENV=/homes/iws/yhruan22/au25-cse599o-hw3/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead
[36m(pid=gcs_server)[0m [2025-12-07 22:32:51,105 E 3162433 3162433] (gcs_server) gcs_server.cc:302: Failed to establish connection to the event+metrics exporter agent. Events and metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[33m(raylet)[0m [2025-12-07 22:32:55,397 E 3162741 3162741] (raylet) main.cc:975: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(pid=3163151)[0m [2025-12-07 22:33:00,314 E 3163151 3163458] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[2025-12-07 22:33:00,524 E 3162064 3163143] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[33m(raylet)[0m It looks like you're creating a detached actor in an anonymous namespace. In order to access this actor in the future, you will need to explicitly connect to this namespace with ray.init(namespace="f6a441ae-74a2-4993-a516-86fffd611015", ...)
[33m(raylet)[0m warning: `VIRTUAL_ENV=/homes/iws/yhruan22/au25-cse599o-hw3/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead
[36m(pid=3163183)[0m [2025-12-07 22:33:00,467 E 3163183 3165027] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14[32m [repeated 37x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
(RDT=True) Time: 2.5339 seconds
(RDT=True) Time: 0.0212 seconds
(RDT=True) Time: 0.0130 seconds
(RDT) Warmup completed. Starting benchmark...
(RDT=True) Time: 0.0130 seconds
(RDT=True) Time: 0.0146 seconds
(RDT=True) Time: 0.0100 seconds
(RDT=True) Time: 0.1617 seconds
(RDT=True) Time: 0.0089 seconds
(RDT=True) Time: 0.0088 seconds
(RDT=True) Time: 0.0080 seconds
(RDT=True) Time: 0.1268 seconds
(RDT=True) Time: 0.0094 seconds
(RDT=True) Time: 0.0086 seconds
(RDT=False) Time: 0.3548 seconds
(RDT=False) Time: 0.2817 seconds
(RDT=False) Time: 0.3068 seconds
(No RDT) Warmup completed. Starting benchmark...
(RDT=False) Time: 0.2870 seconds
(RDT=False) Time: 0.2449 seconds
(RDT=False) Time: 0.1945 seconds
(RDT=False) Time: 0.2264 seconds
(RDT=False) Time: 0.2397 seconds
(RDT=False) Time: 0.1906 seconds
(RDT=False) Time: 0.1910 seconds
(RDT=False) Time: 0.1930 seconds
(RDT=False) Time: 0.2215 seconds
(RDT=False) Time: 0.1913 seconds
RDT: 0.0370 Â± 0.0542 seconds per transfer
No RDT: 0.2180 Â± 0.0307 seconds per transfer
Speedup: 5.89x
[36m(LearnerWorker pid=3166246)[0m [2025-12-07 22:33:17,886 E 3166246 3166448] core_worker_process.cc:825: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14[32m [repeated 2x across cluster][0m
Ray shutdown.
Traceback (most recent call last):
  File "/homes/iws/yhruan22/au25-cse599o-hw3/cse599o_alignment/benchmark_rdt.py", line 165, in <module>
    benchmark_rdt(
  File "/homes/iws/yhruan22/au25-cse599o-hw3/cse599o_alignment/benchmark_rdt.py", line 98, in benchmark_rdt
    with open(output_file, "w") as f:
         ^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'cse599o_alignment/results/rdt/20251207_223213/transfer_only/rdt.json'
